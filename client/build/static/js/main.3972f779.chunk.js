(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{135:function(e,t){},138:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(26),l=a.n(s),o=(a(42),a(82),a(14)),i=a(5),c=a(6),m=a(8),u=a(7),h=a(9),d=(a(83),a(21)),p=a(11),g=a(3),f=a.n(g),E=function(e,t,a,n,r,s){return f.a.post("/api/auth/signup",{username:e,password:t,street:a,houseNumber:n,city:r,postalCode:s}).then((function(e){return e.data})).catch((function(e){return e.response.data}))},v=function(e,t){return f.a.post("/api/auth/login",{username:e,password:t}).then((function(e){return e.data})).catch((function(e){return e.response.data}))},b=a(143),y=a(140),N=function(e){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light nav-menu py-1"},r.a.createElement(p.b,{className:"navbar-brand",to:"/"},r.a.createElement("button",{id:"logo-button",onClick:function(){return e.handleChangeNav({showNewsfeed:!0,showMyEvents:!1,showEventsGoing:!1,showNextEvents:!1})}},"KieZ")),e.user?r.a.createElement("div",{className:"searchRow"},r.a.createElement(b.a,{className:"input-group btn-group",onSubmit:function(t){return e.handleQuery(t,e.history)}},r.a.createElement("select",{className:"custom-select",name:"selectInputfield",onChange:e.handleChange,value:e.selectInputfield},r.a.createElement("option",{value:""},"Select Option"),r.a.createElement("option",{value:"Neighbors"},"Find by Username"),r.a.createElement("option",{value:"Help"},"Find by Lend-item / Help")),r.a.createElement("input",{type:"text",className:"form-control",name:"searchInputfield",placeholder:"Find your Neighbors here",onChange:e.handleChange,value:e.searchInputfield}),r.a.createElement("div",{className:"btn-group"},r.a.createElement(y.a,{variant:"outline-secondary",type:"submit"},"Search")))):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{className:"py-1"},e.user?r.a.createElement(r.a.Fragment,null,r.a.createElement(p.b,{className:"btn btn-outline-success",to:"/".concat(e.user.username)},e.user.username),r.a.createElement(p.b,{className:"btn btn-outline-info mx-3",to:"/events/create"},"Create Event"),r.a.createElement(p.b,{to:"/",onClick:function(){f.a.delete("/api/auth/logout"),e.clearUser(null),e.handleChangeNav({showNewsfeed:!0,showMyEvents:!1,showEventsGoing:!1,showNextEvents:!1})},className:"btn btn-outline-danger"},"Logout")):r.a.createElement(r.a.Fragment,null,r.a.createElement(p.b,{className:"btn btn-outline-info mr-3",to:"/signup"},"Signup"),r.a.createElement(p.b,{className:"btn btn-outline-info",to:"/login"},"Login"))))},C=a(13),w=a(141),S=a(142),F=a(70),O=function(e){var t="",a="Hosted by ".concat(e.event.creater.username," ");return 1===e.event.join.length&&(t="\u2022 ".concat(e.event.join.length," person is going \u2022")),e.event.join.length>1&&(t="\u2022 ".concat(e.event.join.length," people are going \u2022")),e.pastEvent&&e.event.join.length>=1&&(t="\u2022 ".concat(e.event.join.length," person joined \u2022")),r.a.createElement(w.a,{key:e.event._id,className:"mb-3"},r.a.createElement(p.b,{to:"/events/".concat(e.event._id),className:"event-overview-text"},r.a.createElement(S.a,null,r.a.createElement(F.a,{xs:12,md:5,className:"px-0 px-md-2"},r.a.createElement("img",{src:e.event.imageUrl,className:"overview-event-img",width:"90%",alt:e.event.name})),r.a.createElement(F.a,{xs:12,md:7,className:"px-0 px-md-2"},r.a.createElement("h2",{className:"event-overview-heading h2-heading"},e.event.name),r.a.createElement("div",{className:"date"},r.a.createElement("h5",{className:"sub-heading"},e.event.date.slice(0,10)," at"," ",e.event.time.slice(0,5)),r.a.createElement("h5",{className:"sub-heading"},e.event.address.formattedAddress)),r.a.createElement("h5",{className:"overview-host-info"},r.a.createElement("img",{src:e.event.creater.imageUrl,width:"30",height:"30",className:"user-pic mx-1",alt:e.event.creater.username}),a,t)))))},j=function(e){var t=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),n=e.getFullYear();return e="".concat(n,"-").concat(a,"-").concat(t)},A=function(e,t){if(!e||!t)return!1;var a=!1,n=new Date(e),r=t.split(":"),s=Number(r[0]),l=Number(r[1]);return n.setHours(s,l,0),n>new Date&&(a=!0),a},U=function(e,t){var a=new Date(e),n=t.split(":"),r=Number(n[0]),s=Number(n[1]);return a.setHours(r,s,0),a},x=function(e){var t=r.a.createElement("div",null,r.a.createElement("h1",{className:"h1-heading"},"My Created Events"),r.a.createElement("h3",{className:"event-list-h3"},"Upcoming Events: "),e.state.allEvents.filter((function(t){var a=A(t.date,t.time);return t.creater._id===e.user._id&&a&&"event"===t.type})).sort((function(e,t){var a=U(e.date,e.time),n=U(t.date,t.time);return a<n?-1:a>n?1:0})).map((function(e,t){return r.a.createElement(O,{key:t,event:e})}))),a=r.a.createElement("div",null,r.a.createElement("h3",{className:"event-list-h3"},"Past Events: "),e.state.allEvents.filter((function(t){var a=A(t.date,t.time);return t.creater._id===e.state.user._id&&!a&&"event"===t.type})).sort((function(e,t){var a=U(e.date,e.time),n=U(t.date,t.time);return a<n?1:a>n?-1:0})).map((function(e,t){return r.a.createElement(O,{key:t,pastEvent:!0,event:e})})));return r.a.createElement("div",null,t," ",a)},M=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={description:"",imageUrl:""},a.handleFormSubmit=function(e){e.preventDefault();var t=a.state.description;""!==t.trim()&&f.a.post("/api/events",{description:t,type:"post",street:a.props.user.address.street,houseNumber:a.props.user.address.houseNumber,city:a.props.user.address.city,postalCode:a.props.user.address.postalCode,coordinates:a.props.user.address.coordinates,formattedAddress:a.props.user.address.formattedAddress,imageUrl:"https://res.cloudinary.com/dqrjpg3xc/image/upload/v1575651991/kiez/default-event-img.jpg.jpg"}).then(a.props.getAllEvents).then(a.setState({description:""})).catch((function(e){console.log(e)}))},a.handleChange=function(e){var t=e.target.value;a.setState({description:t})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"post-form"},r.a.createElement(b.a,{onSubmit:this.handleFormSubmit},r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Control,{type:"text",as:"textarea",rows:"3",name:"description",onChange:this.handleChange,value:this.state.description,placeholder:"What do you want to tell to your neighbors?"})),r.a.createElement("div",{className:"flex-end-btn"},r.a.createElement(y.a,{type:"submit"},"Post"))))}}]),t}(n.Component),I=function(e,t){var a=71.5*(e.lng-t.lng),n=111.3*(e.lat-t.lat);return Math.sqrt(a*a+n*n).toFixed(1)},k=function(e){var t=r.a.createElement(r.a.Fragment,null,e.allEvents.filter((function(t){return"post"===t.type&&I(t.address.coordinates,e.user.address.coordinates)<3})).sort((function(e,t){return new Date(t.date)-new Date(e.date)})).map((function(t){var a=new Date(t.date),n=a.getDate(),s={0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"}[a.getMonth()];return r.a.createElement("div",{key:t._id,className:"post"},r.a.createElement("div",null,r.a.createElement(p.b,{to:"/".concat(t.creater.username),className:"text-decoration-none"},r.a.createElement("img",{src:t.creater.imageUrl,className:"user-pic",width:"34",height:"34",alt:t.username}),r.a.createElement("span",{className:"username"}," ".concat(t.creater.username))),r.a.createElement("span",{className:"date"},"   ".concat(n,". ").concat(s," ")),t.creater.username===e.user.username?r.a.createElement("button",{className:"bin",widht:"20%",onClick:function(){return a=t._id,void f.a.delete("/api/events/".concat(a)).then((function(t){e.getAllEvents()})).catch((function(e){console.log(e)}));var a}},r.a.createElement("i",{className:"fas fa-trash-alt"})):r.a.createElement("div",null)),r.a.createElement("p",null,t.description.trim().split("\n").map((function(e,t){return r.a.createElement("span",{key:t},e,r.a.createElement("br",null))}))))})));return r.a.createElement("div",null,t)},_=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{user:this.props.user,getAllEvents:this.props.getAllEvents}),r.a.createElement(k,{getAllEvents:this.props.getAllEvents,allEvents:this.props.allEvents,user:this.props.user}))}}]),t}(n.Component),D=function(e){var t=r.a.createElement("div",null,r.a.createElement("h1",{className:"h1-heading"},"Events I\xb4m Joining"),e.allEvents.filter((function(t){var a=A(t.date,t.time);return t.join.includes(e.user._id)&&"event"===t.type&&a})).sort((function(e,t){var a=U(e.date,e.time),n=U(t.date,t.time);return a<n?-1:a>n?1:0})).map((function(e,t){return r.a.createElement(O,{key:t,event:e})})));return r.a.createElement("div",null,t)},G=function(e){var t=r.a.createElement("div",null,r.a.createElement("h1",{className:"h1-heading"},"Upcoming Events in your Neighborhood"),e.state.allEvents.filter((function(t){var a=A(t.date,t.time);return I(e.user.address.coordinates,t.address.coordinates)<3&&a&&"event"===t.type})).sort((function(e,t){var a=U(e.date,e.time),n=U(t.date,t.time);return a<n?-1:a>n?1:0})).map((function(e,t){return r.a.createElement(O,{key:t,event:e})})));return r.a.createElement("div",null,t)},R=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.getAllEvents()}},{key:"render",value:function(){var e=this,t="",a="";if(this.props.chatMsg.length){var n=(t=Object(C.a)(this.props.chatMsg))&&t[t.length-1];n&&(a=n.sender._id!==this.props.user._id?n.sender._id:n.reciever._id)}return r.a.createElement(w.a,{id:"home"},r.a.createElement(S.a,{className:"nested-row"},r.a.createElement(F.a,{md:3,sm:12,className:"home-navbar"},r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("img",{src:"".concat(this.props.user.imageUrl),alt:"".concat(this.props.user.username),width:"150vw",height:"150vw",className:"user-pic",id:"main-page-profile-pic"})),r.a.createElement(S.a,null,r.a.createElement(F.a,{md:12,xs:6},t.length>0&&r.a.createElement(p.b,{to:"/messenger/".concat(a),className:"btn btn-light home-side-nav",id:"home-nav-button4"},r.a.createElement("i",{className:"fas fa-envelope"})," Messenger")),r.a.createElement(F.a,{md:12,xs:6},r.a.createElement(y.a,{className:"home-side-nav",id:"home-nav-button1",variant:"light",onClick:function(){e.props.handleChangeNav({showNewsfeed:!1,showMyEvents:!0,showEventsGoing:!1,showNextEvents:!1})}},"My created events")),r.a.createElement(F.a,{md:12,xs:6},r.a.createElement(y.a,{className:"home-side-nav",id:"home-nav-button2",variant:"light",onClick:function(){return e.props.handleChangeNav({showNewsfeed:!1,showMyEvents:!1,showEventsGoing:!0,showNextEvents:!1})}},"Events I\xb4m joining")),r.a.createElement(F.a,{md:12,xs:6},r.a.createElement(y.a,{className:"home-side-nav",id:"home-nav-button3",variant:"light",onClick:function(){e.props.handleChangeNav({showNewsfeed:!1,showMyEvents:!1,showEventsGoing:!1,showNextEvents:!0})}},"All future events")))),r.a.createElement(F.a,{md:9,id:"newsfeed"},this.props.showNewsfeed&&r.a.createElement(_,{user:this.props.user,allEvents:this.props.allEvents,getAllEvents:this.props.getAllEvents}),this.props.showMyEvents&&r.a.createElement(x,{state:this.props.state,user:this.props.user}),this.props.showEventsGoing&&r.a.createElement(D,{user:this.props.user,allEvents:this.props.allEvents}),this.props.showNextEvents&&r.a.createElement(G,{state:this.props.state,user:this.props.user}))))}}]),t}(n.Component),L=function(e){return f.a.post("/api/upload",e).then((function(e){return e.data})).catch((function(e){return e.response.data}))},q=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("img",{src:this.props.imageUrl,alt:"event-img",width:"100%"}),r.a.createElement("input",{type:"file",onChange:this.props.handleFileUpload}))}}]),t}(n.Component),W=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={type:"event",name:"",street:"",houseNumber:"",city:"",postalCode:"",date:"",time:"",description:"",imageUrl:"https://res.cloudinary.com/dqrjpg3xc/image/upload/v1575651991/kiez/default-event-img.jpg.jpg",photoMessage:null,inputWarning:null},a.handleFormSubmit=function(e){e.preventDefault();var t=a.state.street.trim(),n=a.state.city.trim(),r=a.state.houseNumber.trim();if(n&&t&&r){var s=a.state,l=s.name,o=s.postalCode,i=s.date,c=s.time,m=s.imageUrl,u=s.description;f.a.post("/api/events",{type:"event",name:l,street:t,houseNumber:r,city:n,postalCode:o,date:i,time:c,imageUrl:m,description:u}).then((function(e){e.data.errMessage?a.setState({inputWarning:"* ".concat(e.data.errMessage)}):a.props.history.push("/events/".concat(e.data._id))})).then(a.props.getAllEvents).catch((function(e){console.log(e)}))}else a.setState({inputWarning:"* The street, city and house number input should contain valid characters"})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(o.a)({},n,r))},a.handleFileUpload=function(e){var t=e.target.files[0];if(t)if(t.size>5e6)a.setState({photoMessage:"* Size of image should be less than 5MB",imageUrl:"https://res.cloudinary.com/dqrjpg3xc/image/upload/v1575651991/kiez/default-event-img.jpg.jpg"});else if(["image/jpeg","image/png"].indexOf(t.type)<0)a.setState({photoMessage:"* Format of image should be jpeg or png",imageUrl:"https://res.cloudinary.com/dqrjpg3xc/image/upload/v1575651991/kiez/default-event-img.jpg.jpg"});else{var n=new FormData;n.append("imageUrl",e.target.files[0]),a.setState({uploadOn:!0,photoMessage:""}),L(n).then((function(e){a.setState({imageUrl:e.secure_url,uploadOn:!1})})).catch((function(e){console.log("Error while uploading the file: ",e)}))}else a.setState({imageUrl:"https://res.cloudinary.com/dqrjpg3xc/image/upload/v1575651991/kiez/default-event-img.jpg.jpg"})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(w.a,{className:"container event-form-container mt-2 mb-5"},r.a.createElement("h1",{className:"mx-2 h1-heading"},"Create an event for your neighborhood"),r.a.createElement(S.a,null,r.a.createElement(F.a,{md:5,lg:4,className:"event-form-img-container"},r.a.createElement(q,{imageUrl:this.state.imageUrl,handleFileUpload:this.handleFileUpload}),r.a.createElement("p",{className:"warning"},this.state.photoMessage)),r.a.createElement(F.a,{md:7,lg:8},r.a.createElement(b.a,{onSubmit:this.handleFormSubmit,className:"row mx-lg-5 mt-lg-4"},r.a.createElement(b.a.Group,{className:"col-12"},this.state.inputWarning&&r.a.createElement("p",{className:"warning"},this.state.inputWarning),r.a.createElement(b.a.Label,{htmlFor:"name"},"Name: "),r.a.createElement(b.a.Control,{type:"text",name:"name",id:"name",onChange:this.handleChange,value:this.state.name,required:!0})),r.a.createElement(b.a.Group,{className:"col-8"},r.a.createElement(b.a.Label,{htmlFor:"street"},"Street: "),r.a.createElement(b.a.Control,{type:"text",name:"street",id:"street",onChange:this.handleChange,value:this.state.street,required:!0})),r.a.createElement(b.a.Group,{className:"col-4"},r.a.createElement(b.a.Label,{htmlFor:"houseNumber"},"Nr.: "),r.a.createElement(b.a.Control,{type:"text",name:"houseNumber",id:"houseNumber",onChange:this.handleChange,value:this.state.houseNumber,required:!0})),r.a.createElement(b.a.Group,{className:"col-8"},r.a.createElement(b.a.Label,{htmlFor:"city"},"City: "),r.a.createElement(b.a.Control,{type:"text",name:"city",id:"city",onChange:this.handleChange,value:this.state.city,required:!0})),r.a.createElement(b.a.Group,{className:"col-4"},r.a.createElement(b.a.Label,{htmlFor:"postalCode"},"Postalcode: "),r.a.createElement(b.a.Control,{type:"number",name:"postalCode",min:"0",id:"postalCode",onChange:this.handleChange,value:this.state.postalCode,required:!0})),r.a.createElement(b.a.Group,{className:"col-6"},r.a.createElement(b.a.Label,{htmlFor:"date"},"Date: "),r.a.createElement(b.a.Control,{type:"date",name:"date",id:"date",min:j(new Date),onChange:this.handleChange,value:this.state.date,required:!0})),r.a.createElement(b.a.Group,{className:"col-6"},r.a.createElement(b.a.Label,{htmlFor:"time"},"Time: "),r.a.createElement(b.a.Control,{type:"time",name:"time",id:"time",onChange:this.handleChange,value:this.state.time,required:!0})),r.a.createElement(b.a.Group,{className:"col-12"},r.a.createElement(b.a.Label,{htmlFor:"description"},"Description: "),r.a.createElement(b.a.Control,{type:"text",as:"textarea",rows:"3",name:"description",id:"description",onChange:this.handleChange,value:this.state.description})),r.a.createElement("div",{className:"col-12 flex-end-btn"},r.a.createElement(y.a,{type:"submit"},"Create an Event"))))))}}]),t}(n.Component),J=(a(106),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={userJoins:null},a.handleClick=function(){a.setState({userJoins:!a.state.userJoins},(function(){f.a.put("/api/events/eventUpdate",{event:a.props.event,userJoins:a.state.userJoins}).then((function(){a.props.getSingleEvent(),a.props.getAllEvents()}))}))},a.componentDidMount=function(){a.props.joinedUsers.filter((function(e){return e._id===a.props.user._id})).length?a.setState({userJoins:!0}):a.setState({userJoins:!1})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=!1;return this.props.event.creater._id===this.props.user._id&&(e=!0),r.a.createElement(w.a,{id:"join-info"},r.a.createElement("h4",{className:"sub-heading"},"Host: ","    ",r.a.createElement(p.b,{to:"/".concat(this.props.event.creater.username),className:"text-decoration-none"},r.a.createElement("img",{className:"user-pic guest-pic",src:this.props.event.creater.imageUrl,alt:this.props.event.creater.username})," ",r.a.createElement("span",{className:"username"},this.props.event.creater.username," "))),!e&&this.props.isFutureEvent&&r.a.createElement(y.a,{variant:"light",onClick:this.handleClick,id:"".concat(this.state.userJoins?"joined-button":"join-button")},this.state.userJoins?r.a.createElement("i",{className:"fas fa-user-friends"}):r.a.createElement("i",{className:"fas fa-user-alt"})," ",this.state.userJoins?"Joined":"Join"),r.a.createElement(S.a,{id:"guest-list-row"},this.props.joinedUsers.map((function(e){return r.a.createElement(F.a,{xs:2,md:3,lg:2,className:"guest",key:e._id},r.a.createElement(p.b,{to:"/".concat(e.username),className:"text-decoration-none"},r.a.createElement("img",{className:"user-pic guest-pic",src:e.imageUrl,alt:e.username})," ",r.a.createElement("p",{className:"username mb-0"},e.username)))}))))}}]),t}(n.Component)),P=function(e){var t=r.a.createElement(r.a.Fragment,null,e.event.comments.sort((function(e,t){return new Date(e.date)-new Date(t.date)})).map((function(t){return r.a.createElement("div",{key:t._id,className:"comment-box"},r.a.createElement("div",null,r.a.createElement(p.b,{to:"/".concat(t.author.username),className:"text-decoration-none"},r.a.createElement("img",{src:t.author.imageUrl,className:"user-pic",width:"40",height:"40",alt:t.author.username})," ",r.a.createElement("span",{className:"username"},t.author.username)),t.author.username===e.user.username?r.a.createElement("button",{className:"bin",widht:"20%",onClick:function(){return a=t._id,void f.a.put("/api/comments/".concat(e.event._id),{commentId:a}).then((function(){e.getSingleEvent(),e.getAllEvents()}));var a}},r.a.createElement("i",{className:"fas fa-trash-alt"})):r.a.createElement("div",null)),r.a.createElement("p",null,t.content.trim().split("\n").map((function(e,t){return r.a.createElement("span",{key:t},e,r.a.createElement("br",null))}))))})));return e.event?r.a.createElement("div",null,t):r.a.createElement("div",null)},z=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={content:""},a.handleChange=function(e){var t=e.target.value;a.setState({content:t})},a.handleFormSubmit=function(e){e.preventDefault();var t=a.state.content.trim();t&&f.a.post("/api/comments/".concat(a.props.eventId),{content:t,author:a.props.user._id}).then(a.props.getAllEvents).then(a.setState({content:""})).then((function(){a.props.getSingleEvent(),a.props.getAllEvents()})).catch((function(e){console.log(e)}))},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(b.a,{onSubmit:this.handleFormSubmit},r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Control,{type:"text",as:"textarea",rows:"3",name:"content",onChange:this.handleChange,value:this.state.content,placeholder:"write a comment or question"})),r.a.createElement("div",{className:"flex-end-btn"},r.a.createElement(y.a,{type:"submit"},"Send"))))}}]),t}(n.Component),T=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(P,{user:this.props.user,event:this.props.event,getSingleEvent:this.props.getSingleEvent,getAllEvents:this.props.getAllEvents}),r.a.createElement(z,{user:this.props.user,eventId:this.props.eventId,getSingleEvent:this.props.getSingleEvent,getAllEvents:this.props.getAllEvents}))}}]),t}(n.Component),H=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={editForm:!1,event:{},name:"",address:null,imageUrl:"",street:"",houseNumber:"",city:"",postalCode:"",date:"",time:"",description:"",dateForForm:"",timeForForm:"",photoMessage:null,inputWarning:null},a.getSingleEvent=function(){var e=a.props.match.params;f.a.get("/api/events/".concat(e.id)).then((function(e){var t=e.data.time.split(":"),n=t[0],r=t[1],s="".concat(n,":").concat(r,":00");a.setState({event:e.data,name:e.data.name,address:e.data.address,street:e.data.address.street,houseNumber:e.data.address.houseNumber,city:e.data.address.city,postalCode:e.data.address.postalCode,date:e.data.date,time:e.data.time,imageUrl:e.data.imageUrl,description:e.data.description,originalImage:e.data.imageUrl,dateForForm:j(new Date(e.data.date)),timeForForm:s})})).catch((function(e){console.log(e)}))},a.deleteEvent=function(){var e=a.state.event._id;f.a.delete("/api/events/".concat(e)).then((function(e){a.props.history.push("/")})).then(a.props.getAllEvents).catch((function(e){console.log(e)}))},a.toggleEdit=function(){a.setState({editForm:!a.state.editForm})},a.handleChange=function(e){a.setState(Object(o.a)({},e.target.name,e.target.value))},a.handleFileUpload=function(e){var t=e.target.files[0];if(t)if(t.size>5e6)a.setState({photoMessage:"* Size of image should be less than 5MB",imageUrl:a.state.originalImage});else if(["image/jpeg","image/png"].indexOf(t.type)<0)a.setState({photoMessage:"* Format of image should be jpeg or png",imageUrl:a.state.originalImage});else{var n=new FormData;n.append("imageUrl",e.target.files[0]),a.setState({uploadOn:!0,photoMessage:""}),L(n).then((function(e){a.setState({imageUrl:e.secure_url,uploadOn:!1})})).catch((function(e){console.log("Error while uploading the file: ",e)}))}else a.setState({imageUrl:a.state.originalImage})},a.handleFormSubmit=function(e){e.preventDefault();var t=a.props.match.params.id,n=a.state.dateForForm,r=a.state.timeForForm,s=a.state.street.trim(),l=a.state.houseNumber.trim(),o=a.state.city.trim();if(s&&o&&l){var i=a.state,c=i.name,m=i.postalCode,u=i.imageUrl,h=i.description;f.a.put("/api/events/".concat(t),{name:c,street:s,houseNumber:l,city:o,postalCode:m,imageUrl:u,date:n,time:r,description:h}).then((function(e){if(e.data.errMessage)a.setState({inputWarning:"* ".concat(e.data.errMessage)});else{var t=e.data,n=t.name,r=t.address,s=t.imageUrl,l=t.date,o=t.time,i=t.description;a.setState({editForm:!1,event:e.data,name:n,address:r,imageUrl:s,date:l,time:o,description:i,inputWarning:"",photoMessage:""},(function(){a.getSingleEvent()}))}})).catch((function(e){console.log(e)}))}else a.setState({inputWarning:"* The street, city and house number input should contain valid characters"})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getSingleEvent()}},{key:"render",value:function(){if(!this.state.date)return r.a.createElement("div",{className:"event-detail-page"});if("event"!==this.state.event.type)return r.a.createElement("div",{className:"event-detail-page"},r.a.createElement("h1",null,"Sorry, this page isn't available."),r.a.createElement("p",null,"The link you used may be broken, or the page may have been removed."));var e=this.state.description,t=A(this.state.date,this.state.time),a=!1;return this.state.event.creater._id===(this.props.state.user&&this.props.state.user._id)&&(a=!0),!1===this.state.editForm?r.a.createElement(w.a,{className:"mt-2 mt-md-5 event-detail-page"},r.a.createElement("div",{className:"d-flex justify-content-end mb-2 mb-md-4"},t&&a&&r.a.createElement(y.a,{variant:"outline-info",className:"mx-2",onClick:this.toggleEdit},"\u270e"," Edit event"),a&&r.a.createElement(y.a,{variant:"outline-danger",onClick:this.deleteEvent},"\u2715"," Delete event")),r.a.createElement(S.a,null,r.a.createElement(F.a,{xs:12,md:6},r.a.createElement("img",{src:this.state.imageUrl,className:"event-img",alt:this.state.name})),r.a.createElement(F.a,{xs:12,md:6},r.a.createElement("h1",{className:"h1-heading"},this.state.name),r.a.createElement("h5",{className:"date sub-heading"},this.state.date.slice(0,10)," at ",this.state.time.slice(0,5)),r.a.createElement("h5",{className:"date sub-heading"},this.state.address.formattedAddress),r.a.createElement("p",null,e.trim().split("\n").map((function(e,t){return r.a.createElement("span",{key:t},e,r.a.createElement("br",null))}))))),this.props.state.user._id&&r.a.createElement(S.a,{className:"mt-md-5"},r.a.createElement(F.a,{xs:12,md:6},r.a.createElement(J,{event:this.state.event,joinedUsers:this.state.event.join,user:this.props.user,allUsers:this.props.allUsers,getSingleEvent:this.getSingleEvent,getAllEvents:this.props.getAllEvents,isFutureEvent:t})),r.a.createElement(F.a,{xs:12,md:6,id:"comment-area"},r.a.createElement(T,{user:this.props.user,eventId:this.props.match.params.id,event:this.state.event,getSingleEvent:this.getSingleEvent,getAllEvents:this.props.getAllEvents})))):!0===this.state.editForm?r.a.createElement(w.a,{className:"container event-form-container mt-2 mb-5"},r.a.createElement("h1",null,"Edit event"),r.a.createElement(S.a,null,r.a.createElement(F.a,{md:5,lg:4,className:"event-form-img-container"},r.a.createElement(q,{imageUrl:this.state.imageUrl,handleFileUpload:this.handleFileUpload}),this.state.photoMessage&&r.a.createElement("p",{className:"warning"},this.state.photoMessage)),r.a.createElement(F.a,{md:7,lg:8},r.a.createElement(b.a,{onSubmit:this.handleFormSubmit,className:"row mx-lg-5"},r.a.createElement(b.a.Group,{className:"col-12"},this.state.inputWarning&&r.a.createElement("p",{className:"warning"},this.state.inputWarning),r.a.createElement(b.a.Label,{htmlFor:"name"},"Name: "),r.a.createElement(b.a.Control,{type:"text",name:"name",id:"name",onChange:this.handleChange,value:this.state.name,required:!0})),r.a.createElement(b.a.Group,{className:"col-8"},r.a.createElement(b.a.Label,{htmlFor:"street"},"Street: "),r.a.createElement(b.a.Control,{type:"text",name:"street",id:"street",onChange:this.handleChange,value:this.state.street,required:!0})),r.a.createElement(b.a.Group,{className:"col-4"},r.a.createElement(b.a.Label,{htmlFor:"houseNumber"},"Nr.: "),r.a.createElement(b.a.Control,{type:"text",name:"houseNumber",id:"houseNumber",onChange:this.handleChange,value:this.state.houseNumber,required:!0})),r.a.createElement(b.a.Group,{className:"col-8"},r.a.createElement(b.a.Label,{htmlFor:"city"},"City: "),r.a.createElement(b.a.Control,{type:"text",name:"city",id:"city",onChange:this.handleChange,value:this.state.city,required:!0})),r.a.createElement(b.a.Group,{className:"col-4"},r.a.createElement(b.a.Label,{htmlFor:"postalCode"},"Postalcode: "),r.a.createElement(b.a.Control,{type:"number",name:"postalCode",id:"postalCode",onChange:this.handleChange,value:this.state.postalCode,min:"0",required:!0})),r.a.createElement(b.a.Group,{className:"col-6"},r.a.createElement(b.a.Label,{htmlFor:"date"},"Date: "),r.a.createElement(b.a.Control,{type:"date",name:"dateForForm",id:"date",min:j(new Date),onChange:this.handleChange,value:this.state.dateForForm,required:!0})),r.a.createElement(b.a.Group,{className:"col-6"},r.a.createElement(b.a.Label,{htmlFor:"time"},"Time: "),r.a.createElement(b.a.Control,{type:"time",name:"timeForForm",id:"time",onChange:this.handleChange,value:this.state.timeForForm,required:!0})),r.a.createElement(b.a.Group,{className:"col-12"},r.a.createElement(b.a.Label,{htmlFor:"description"},"Description: "),r.a.createElement(b.a.Control,{type:"text",as:"textarea",rows:"3",name:"description",id:"description",onChange:this.handleChange,value:this.state.description})),r.a.createElement("div",{className:"col-12 flex-end-btn"},r.a.createElement(y.a,{type:"submit"},"Save changes")))))):void 0}}]),t}(n.Component),B=function(e){var t,a=e.user.address.coordinates;t=Object(C.a)(e.allUsers).filter((function(t){var n=t.address.coordinates;return I(a,n)<=3&&t.username!==e.user.username}));var n=Object(C.a)(t).sort((function(e,t){var n=I(a,e.address.coordinates),r=I(a,t.address.coordinates);return n<r?-1:n>r?1:0})),s=e.searchInput.trim();"Help"===e.select&&s&&(n=n.filter((function(e){var t=!0,a=!1,n=void 0;try{for(var r,l=e.offerService[Symbol.iterator]();!(t=(r=l.next()).done);t=!0){if(r.value.toLowerCase().includes(s.toLowerCase()))return!0}}catch(h){a=!0,n=h}finally{try{t||null==l.return||l.return()}finally{if(a)throw n}}var o=!0,i=!1,c=void 0;try{for(var m,u=e.offerStuff[Symbol.iterator]();!(o=(m=u.next()).done);o=!0){if(m.value.toLowerCase().includes(s.toLowerCase()))return!0}}catch(h){i=!0,c=h}finally{try{o||null==u.return||u.return()}finally{if(i)throw c}}return!1}))),"Neighbors"===e.select&&s&&(n=n.filter((function(e){return e.username.toLowerCase().includes(s.toLowerCase())})));var l="",o="",i=Object(C.a)(n).map((function(e,t){e.offerService&&(l=e.offerService.map((function(e,t){return r.a.createElement(F.a,{key:t,xs:6,md:3,className:"px-0"},r.a.createElement("span",{className:"help-item"},r.a.createElement("i",{className:"fas fa-icons"})," "),r.a.createElement("span",null,e))}))),e.offerStuff&&(o=e.offerStuff.map((function(e,t){return r.a.createElement(F.a,{key:t,xs:6,md:3,className:"px-0"},r.a.createElement("span",{className:"toolbox"},r.a.createElement("i",{className:"fas fa-toolbox"})," "),r.a.createElement("span",null,e))})));var n=I(a,e.address.coordinates);return r.a.createElement(w.a,{key:t,className:"each-neighbor-card"},r.a.createElement("div",{className:"pb-1 pt-2 px-lg-3"},r.a.createElement(p.b,{to:"/".concat(e.username),style:{textDecoration:"none",color:"black"}},r.a.createElement(S.a,null,r.a.createElement(F.a,{xs:4,md:2,className:"pr-md-0"},r.a.createElement("img",{src:e.imageUrl,className:"user-pic search-result-pic",alt:e.username}),r.a.createElement("div",{className:"flex-space-between"},r.a.createElement("span",{className:"credit-locat-display"},r.a.createElement("i",{className:"fas fa-map-marker-alt"})," ",n," km"),r.a.createElement("span",{className:"credit-locat-display"},r.a.createElement("i",{className:"far fa-credit-card"})," ",e.credits))),r.a.createElement(F.a,{xs:8,md:10,className:"pl-md-5 px-0"},r.a.createElement("h4",{className:"mb-0"},e.username),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h6",{className:"search-lend-help-title",style:{color:"grey"}},"I can lend:")," ",r.a.createElement(S.a,{style:{width:"100%",margin:0}},o)),l&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h6",{className:"search-lend-help-title",style:{color:"grey"}},"I can help:"," "),r.a.createElement(S.a,{style:{width:"100%",margin:0}},l)))))))}));return r.a.createElement("div",{id:"search-result"},r.a.createElement("h1",{className:"search-result-heading"},"Neighbors around you (within 3 km)"),i.length>0?r.a.createElement("div",{className:"neighbor-card"},i):r.a.createElement("h3",{className:"search-result-heading"},"No Result"))},Y=function(e){var t="";e.chatMsg.length&&(t=Object(C.a)(e.chatMsg).filter((function(t){return t.sender._id===e.user._id||t.reciever._id===e.user._id})));var a={},n=[];Object(C.a)(t).forEach((function(t){t.sender._id!==e.user._id?(a[t.sender.username]={neighborId:t.sender._id,sender:t.sender._id,msg:t.chatMsg,timeStamp:t.createdAt,imageUrl:t.sender.imageUrl},n.push(t.sender.username)):(a[t.reciever.username]={neighborId:t.reciever._id,sender:t.sender._id,msg:t.chatMsg,timeStamp:t.createdAt,imageUrl:t.reciever.imageUrl},n.push(t.reciever.username))}));var s={1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},l=new Set(n.reverse()),o=Array.from(l);return o=o.map((function(t,n){var l=new Date(a[t].timeStamp),o=l.getDate(),i=l.getMonth(),c=s[i+1],m=a[t].msg.slice(0,25);return r.a.createElement(p.c,{key:n,to:"/messenger/".concat(a[t].neighborId),style:{textDecoration:"none",color:"black"},exact:!0,className:"flex-display-container py-3 px-2 message-selector",activeClassName:"active-message-selector",onClick:e.hidePanelArea},r.a.createElement("img",{src:a[t].imageUrl,alt:"chat-neighbor-pic",width:"50",height:"50",className:"user-pic mr-2 ml-1"}),r.a.createElement("div",null,r.a.createElement("div",{className:"m-0"},r.a.createElement("strong",null,t)," ",r.a.createElement("span",{style:{color:"grey"}},"\u2022 ".concat(o," ").concat(c," \u2022"))),r.a.createElement("div",{className:"m-0"},a[t].sender===e.user._id?r.a.createElement("span",null,"You: "):r.a.createElement(r.a.Fragment,null),r.a.createElement("span",{style:{color:"grey"}},m))))})),r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"pl-2"},"Messenger"),r.a.createElement("div",{className:"p-0 messenger-nav"},o))},Q=function(e){var t=e.match.params.neighborId,a="";e.chatMsg.length&&(a=Object(C.a)(e.chatMsg).reverse().filter((function(a){return a.sender._id===e.user._id&&a.reciever._id===t||a.reciever._id===e.user._id&&a.sender._id===t})));var s=Object(C.a)(a).map((function(t,a){var n=t.chatMsg.trim().split("\n").map((function(e,t){return r.a.createElement("span",{key:t},e,r.a.createElement("br",null))}));return t.sender._id!==e.user._id?r.a.createElement("div",{key:a,className:"d-flex justify-content-start"},r.a.createElement("div",{className:"chat-bubble"},r.a.createElement("b",{style:{color:"#66AD93"}},t.sender.username),r.a.createElement("p",null,n))):r.a.createElement("div",{key:a,className:"d-flex justify-content-end "},r.a.createElement("div",{className:"chat-bubble"},r.a.createElement("b",{style:{color:"#FF8C00"}},"You"),r.a.createElement("p",null,n)))})),l="",o="";if(a[0])a[0].sender.username!==e.user.username?(l=a[0].sender.username,o=a[0].sender.imageUrl):(l=a[0].reciever.username,o=a[0].reciever.imageUrl);else if(a){var i=Object(C.a)(e.allUsers).filter((function(e){return e._id===t}));l=i[0].username,o=i[0].imageUrl}return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"flex-display-container px-2 py-2",style:{backgroundColor:"#D5F2E3",justifyContent:"space-between",alignItems:"center"}},r.a.createElement("h3",{className:"mb-0"},r.a.createElement(p.b,{style:{textDecoration:"none",color:"black"},to:"/".concat(l)},r.a.createElement("img",{src:o,width:"40",height:"40",className:"user-pic",alt:"neighbor_pic"})," ",l)),window.innerWidth<=600||window.innerHeight<=600?r.a.createElement(y.a,{id:"chat-area-change-size-btn",variant:"outline-success",onClick:e.hideChatArea},"back to list"):""),r.a.createElement("div",{className:"p-4 chat-area-msg-display"},s),r.a.createElement("div",null,r.a.createElement(b.a,{onSubmit:function(a){e.handleChatInputSubmit(a,t)}},r.a.createElement(b.a.Control,{as:"textarea",rows:"3",name:"chatInput",onChange:e.handleChange,value:e.chatInput,placeholder:"Text here..."}),r.a.createElement("div",{className:"d-flex justify-content-end"},r.a.createElement(y.a,{className:"mx-2",type:"submit",variant:"outline-success"},"Send")))))},K=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(m.a)(this,Object(u.a)(t).call(this))).hideChatArea=function(){(window.innerWidth<=600||window.innerHeight<=600)&&(e.panelArea.current.style.display="block",e.chatArea.current.style.display="none")},e.hidePanelArea=function(){(window.innerWidth<=600||window.innerHeight<=600)&&(e.panelArea.current.style.display="none",e.chatArea.current.style.display="block")},e.panelArea=r.a.createRef(),e.chatArea=r.a.createRef(),e}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){(window.innerWidth<=600||window.innerHeight<=600)&&this.props.showChatArea&&(this.panelArea.current.style.display="none",this.chatArea.current.style.display="block",this.props.setChatArea(!1))}},{key:"render",value:function(){return r.a.createElement(w.a,{fluid:!0,className:"p-0 flex-display-container"},r.a.createElement("div",{className:"px-0 panel-area",ref:this.panelArea},r.a.createElement(Y,{user:this.props.user,chatMsg:this.props.chatMsg,hidePanelArea:this.hidePanelArea})),r.a.createElement("div",{className:"p-0 chat-area-container",ref:this.chatArea},r.a.createElement(Q,Object.assign({user:this.props.user,chatMsg:this.props.chatMsg,chatInput:this.props.chatInput,handleChange:this.props.handleChange,handleChatInputSubmit:this.props.handleChatInputSubmit,allUsers:this.props.allUsers},this.props,{hideChatArea:this.hideChatArea}))))}}]),t}(n.Component),$=a(144),V=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",street:"",houseNumber:"",city:"",postalCode:"",password:"",error:""},a.handleChange=function(e){a.setState(Object(o.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t=a.state.username,n=/^[a-z0-9]+$/i.test(t),r=a.state.password,s=a.state.street.trim(),l=a.state.city.trim(),o=a.state.houseNumber.trim();n?t.length<3||t.length>12?a.setState({error:"The length of username should be 3-12 characters"}):r.length<8?a.setState({error:"Password should contain at least 8 characters"}):s&&l&&o?E(t,r,s,o,l,a.state.postalCode).then((function(e){e.message?a.setState({error:e.message}):(a.props.setUser(e),a.props.history.push("/"))})):a.setState({error:"The street, city and house number input should contain valid characters "}):a.setState({error:"Username can contain only english letters or numbers"})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"background-image"},r.a.createElement("div",{className:"signup"},r.a.createElement(w.a,null,r.a.createElement("h2",null,"Signup"),r.a.createElement(b.a,{onSubmit:this.handleSubmit},r.a.createElement(S.a,null,r.a.createElement(b.a.Group,{className:"col-6"},r.a.createElement(b.a.Label,{htmlFor:"username"},"Username: "),r.a.createElement(b.a.Control,{type:"text",name:"username",id:"username",value:this.state.username,onChange:this.handleChange,required:!0})),r.a.createElement(b.a.Group,{className:"col-6"},r.a.createElement(b.a.Label,{htmlFor:"password"},"Password: "),r.a.createElement(b.a.Control,{type:"password",name:"password",id:"password",placeholder:"min. 8 characters",value:this.state.password,onChange:this.handleChange,required:!0}))),r.a.createElement(S.a,null,r.a.createElement(b.a.Group,{className:"col-8 "},r.a.createElement(b.a.Label,{htmlFor:"street"},"Street: "),r.a.createElement(b.a.Control,{type:"text",name:"street",id:"street",value:this.state.street,onChange:this.handleChange,required:!0})),r.a.createElement(b.a.Group,{className:"col-4 "},r.a.createElement(b.a.Label,{htmlFor:"houseNumber"},"Nr.: "),r.a.createElement(b.a.Control,{type:"text",name:"houseNumber",id:"houseNumber",onChange:this.handleChange,value:this.state.houseNumber,required:!0}))),r.a.createElement(S.a,null,r.a.createElement(b.a.Group,{className:"col-6"},r.a.createElement(b.a.Label,{htmlFor:"postalCode",id:"postal-code"},"Postalcode:"," "),r.a.createElement(b.a.Control,{type:"number",name:"postalCode",id:"postalCode",onChange:this.handleChange,value:this.state.postalCode,min:"0",required:!0})),r.a.createElement(b.a.Group,{className:"col-6"},r.a.createElement(b.a.Label,{htmlFor:"city"},"City: "),r.a.createElement(b.a.Control,{type:"text",name:"city",id:"city",onChange:this.handleChange,value:this.state.city,required:!0}))),this.state.error&&r.a.createElement($.a,{variant:"danger"},this.state.error),r.a.createElement(y.a,{variant:"danger",type:"submit"},"Sign up")))))}}]),t}(n.Component),Z=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",error:""},a.handleChange=function(e){a.setState(Object(o.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),v(a.state.username,a.state.password).then((function(e){e.message?a.setState({error:e.message}):(a.props.setUser(e),a.props.history.push("/"))}))},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"background-image"},r.a.createElement("div",{className:"login-form"},r.a.createElement("h2",null,"Login"),r.a.createElement(b.a,{onSubmit:this.handleSubmit},r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Label,{htmlFor:"username"},"Username: "),r.a.createElement(b.a.Control,{type:"text",name:"username",id:"username",value:this.state.username,onChange:this.handleChange})),r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Label,{htmlFor:"password"},"Password: "),r.a.createElement(b.a.Control,{type:"password",name:"password",id:"password",value:this.state.password,onChange:this.handleChange})),this.state.error&&r.a.createElement($.a,{variant:"danger"},this.state.error),r.a.createElement(y.a,{variant:"danger",type:"submit"},"Log in"))))}}]),t}(n.Component),X=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",{className:"mt-md-5 mb-2 profile-detail-subhead",style:{color:"grey"}},"About Me \xa0\xa0",this.props.sameUser&&!this.props.state.showAboutMeForm&&r.a.createElement(y.a,{onClick:function(){return e.props.toggleForm({showAboutMeForm:!e.props.state.showAboutMeForm})},variant:"outline-info"},"\u270e")),this.props.state.showAboutMeForm&&r.a.createElement(b.a,{onSubmit:this.props.updateAboutMe},r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Control,{as:"textarea",rows:"3",name:"aboutMe",onChange:this.props.handleChange,value:this.props.state.aboutMe})),r.a.createElement("div",{className:"d-flex justify-content-end"},r.a.createElement(y.a,{type:"submit",variant:"outline-success",className:"mr-1"},"Add"),r.a.createElement(y.a,{onClick:this.props.cancelEditAboutMe,variant:"outline-danger"},"Cancel"))),!this.props.state.showAboutMeForm&&r.a.createElement("p",{className:"mt-3 mb-md-5"},this.props.state.aboutMe&&this.props.state.aboutMe.trim().split("\n").map((function(e,t){return r.a.createElement("span",{key:t},e,r.a.createElement("br",null))}))))}}]),t}(n.Component),ee=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"profile-page-img-container"},r.a.createElement("img",{className:"user-pic",src:this.props.imageUrl,alt:""}),this.props.canUpdateImg&&r.a.createElement("span",null,"Preview")),this.props.sameUser&&r.a.createElement("form",{onSubmit:this.props.handleSubmitFile},r.a.createElement("input",{type:"file",id:"pic-input",onChange:this.props.handleFileChange}),this.props.canUpdateImg&&r.a.createElement(y.a,{type:"submit",variant:"outline-info"},"Upload")),this.props.photoMessage&&r.a.createElement("p",{style:{color:"red"}},this.props.photoMessage))}}]),t}(n.Component),te=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=r.a.createElement(r.a.Fragment,null);return this.props.offerService&&(t=Object(C.a)(this.props.offerService).map((function(t,a){return r.a.createElement(n.Fragment,{key:a},r.a.createElement("div",{className:"help-item-list"},r.a.createElement("li",null,r.a.createElement("span",{className:"mr-2 help-item "},r.a.createElement("i",{className:"fas fa-icons"}))," ",r.a.createElement("span",null,t)),e.props.showOfferServiceForm&&r.a.createElement("button",{onClick:function(){return e.props.deleteService(t)}},"\xd7")))}))),r.a.createElement("div",{className:"my-md-5"},r.a.createElement("h3",{className:"profile-detail-subhead"},"I can help..."," ",this.props.sameUser&&!this.props.showOfferServiceForm&&r.a.createElement(y.a,{onClick:function(){return e.props.toggleForm({showOfferServiceForm:!e.props.showOfferServiceForm})},variant:"outline-info"},"\u270e"," Edit")),r.a.createElement("ul",{className:"pl-0",style:{listStyleType:"none"}},t),this.props.showOfferServiceForm&&r.a.createElement(b.a,{onSubmit:this.props.handleSubmitOfferService},r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Control,{id:"help-input",type:"text",name:"serviceInput",onChange:this.props.handleChange,value:this.props.serviceInput})),r.a.createElement("div",{className:"add-service-stuff-btn"},r.a.createElement(y.a,{type:"submit",variant:"outline-success",className:"mr-2"},"Add"),r.a.createElement(y.a,{onClick:function(){return e.props.toggleForm({showOfferServiceForm:!e.props.showOfferServiceForm})},variant:"outline-info"},"Done"))))}}]),t}(n.Component),ae=function(e){var t=r.a.createElement(r.a.Fragment,null);return e.offerStuff&&(t=Object(C.a)(e.offerStuff).map((function(t,a){return r.a.createElement(n.Fragment,{key:a},r.a.createElement("div",{className:"help-item-list"},r.a.createElement("li",null,r.a.createElement("span",{className:"mr-2 toolbox"},r.a.createElement("i",{className:"fas fa-toolbox"})," ")," ",r.a.createElement("span",null,t)),e.showOfferStuffForm&&r.a.createElement("button",{onClick:function(){return e.deleteStuff(t)}},"\xd7")))}))),r.a.createElement("div",{className:"my-md-5"},r.a.createElement("h3",{className:"profile-detail-subhead"},"I can lend..."," ",e.sameUser&&!e.showOfferStuffForm&&r.a.createElement(y.a,{onClick:function(){return e.toggleForm({showOfferStuffForm:!e.showOfferStuffForm})},variant:"outline-info"},"\u270e"," Edit")),r.a.createElement("ul",{className:"pl-0",style:{listStyleType:"none"}},t),e.showOfferStuffForm&&r.a.createElement(b.a,{onSubmit:e.handleSubmitOfferStuff},r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Control,{type:"text",name:"stuffInput",id:"stuff-input",onChange:e.handleChange,value:e.stuffInput})),r.a.createElement("div",{className:"add-service-stuff-btn"},r.a.createElement(y.a,{type:"submit",variant:"outline-success",className:"mr-2"},"Add"),r.a.createElement(y.a,{onClick:function(){return e.toggleForm({showOfferStuffForm:!e.showOfferStuffForm})},variant:"outline-info"},"Done"))))},ne=a(72),re=a.n(ne),se=function(e){return Object(C.a)(e.reference).map((function(e,t){var a=e.content.split("\n").map((function(e,t){return r.a.createElement("span",{key:t},e,r.a.createElement("br",null))})),s="\u2605".repeat(e.rating);return r.a.createElement(n.Fragment,{key:t},r.a.createElement(S.a,{className:"my-3"},r.a.createElement(F.a,{className:"mr-2",xs:2,lg:1},e.author.imageUrl&&r.a.createElement("img",{className:"user-pic mt-1",src:e.author.imageUrl,alt:"author_picture",width:"40",height:"40"})),r.a.createElement(F.a,null,e.author.username?r.a.createElement(p.b,{style:{textDecoration:"none",color:"black"},to:"/".concat(e.author.username)},r.a.createElement("strong",null,e.author.username)):r.a.createElement("strong",{style:{color:"grey",fontStyle:"italic"}},"Deleted"),r.a.createElement("p",{className:"mb-1",style:{color:"#ffcc00",fontSize:20}},s),r.a.createElement("p",null,a))))}))},le=function(e){var t="";return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"mt-md-5 reference-heading h2-heading"},"Reference"," ",!e.sameUser&&!e.showReferenceForm&&e.user&&r.a.createElement(y.a,{onClick:function(){return e.toggleForm({showReferenceForm:!e.showReferenceForm})},variant:"outline-info"},"\u270e"," Add a reference")),r.a.createElement(w.a,null,e.showReferenceForm&&!e.sameUser&&r.a.createElement(n.Fragment,null,r.a.createElement($.a,{variant:"warning"},"Your current credit: ",e.authorCredits),e.showNotEnoughCredit&&r.a.createElement($.a,{variant:"warning"},"You don't have enough credit to transfer."),e.showNeedtoWriteSth&&r.a.createElement($.a,{variant:"warning"},"You need to write something."),r.a.createElement(S.a,{className:"my-3"},r.a.createElement(F.a,{className:"mr-2",xs:2,lg:1},r.a.createElement("img",{className:"user-pic mt-1",src:e.user.imageUrl,alt:"author_picture",width:"40",height:"40"})),r.a.createElement(F.a,null,r.a.createElement(b.a,{onSubmit:function(a){return e.addReference(a,t)}},e.showReferenceAlert&&r.a.createElement($.a,{variant:"danger"},"IMPORTANT!!",r.a.createElement("br",null),"Are you sure you want to submit this reference?",r.a.createElement("br",null),"Submitted reference CANNOT be modified or deleted.",r.a.createElement("br",null),r.a.createElement(y.a,{type:"submit",ref:function(e){t=e},name:"final_submit",variant:"outline-success",className:"mt-3"},"Confirm"),r.a.createElement(y.a,{onClick:function(){return e.toggleForm({showReferenceAlert:!1})},variant:"outline-danger",className:"mt-3 mx-2"},"Cancel")),r.a.createElement(S.a,null,r.a.createElement(F.a,{md:6},r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Label,null,"Give Credits to ",r.a.createElement("strong",null,e.profileOwner)," ","(optional) :"),r.a.createElement(b.a.Control,{type:"number",name:"creditInput",placeholder:"Write a number",min:"0",step:"1",onChange:e.handleCreditChange,value:e.creditInput}))),r.a.createElement(F.a,{md:1}),r.a.createElement(F.a,{md:5},r.a.createElement(b.a.Label,null,"Rating :"),r.a.createElement(re.a,{value:e.rating,count:5,onChange:function(t){e.handleRatingChange(t)},size:30,half:!1,color2:"#ffd700"}))),r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Control,{as:"textarea",rows:"3",name:"referenceInput",onChange:e.handleRefChange,value:e.referenceInput,required:!0,placeholder:"Write your reference here"})),!e.showReferenceAlert&&r.a.createElement("div",{className:"d-flex justify-content-end"},r.a.createElement(y.a,{type:"submit",variant:"outline-success"},"Add"),r.a.createElement(y.a,{onClick:e.cancelEditReference,variant:"outline-danger",className:"mx-2"},"Cancel")))))),r.a.createElement(se,{reference:e.reference})))},oe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={_id:null,username:"",address:"",street:"",houseNumber:"",city:"",postalCode:"",offerStuff:"",offerService:"",imageUrl:"",aboutMe:"",reference:"",credits:"",event:"",following:"",showAboutMeForm:!1,showAddressForm:!1,showOfferServiceForm:!1,showOfferStuffForm:!1,showReferenceForm:!1,showReferenceAlert:!1,showDeleteAlert:!1,showNotEnoughCredit:!1,showNeedtoWriteSth:!1,serviceInput:"",stuffInput:"",referenceInput:"",creditInput:"",authorCredits:a.props.user.credits,rating:0,photoMessage:null,addressInvalidMsg:null,canUpdateImg:!1,originalImgUrl:""},a.getData=function(){var e=a.props.match.params.username;f.a.get("/api/user/".concat(e)).then((function(e){a.setState({_id:e.data._id,username:e.data.username,address:e.data.address,street:e.data.address.street,houseNumber:e.data.address.houseNumber,city:e.data.address.city,postalCode:e.data.address.postalCode,offerStuff:e.data.offerStuff,offerService:e.data.offerService,imageUrl:e.data.imageUrl,aboutMe:e.data.aboutMe,reference:e.data.reference.reverse(),credits:e.data.credits,event:e.data.event,following:e.data.following,originalImgUrl:e.data.imageUrl})})).catch((function(e){console.log(e),404===e.response.status&&a.setState({error:e.response.data.message})}))},a.handleChange=function(e){a.setState(Object(o.a)({},e.target.name,e.target.value))},a.toggleForm=function(e){a.setState(e)},a.updateAddress=function(e){e.preventDefault();var t=a.state.street.trim(),n=a.state.city.trim(),r=a.state.houseNumber.trim();t&&n&&r?f.a.put("/api/user/address/".concat(a.state.username),{street:a.state.street,houseNumber:a.state.houseNumber,city:a.state.city,postalCode:a.state.postalCode}).then((function(e){e.data.message?a.setState({addressInvalidMsg:e.data.message}):(a.setState({address:e.data.address,street:e.data.address.street,houseNumber:e.data.address.houseNumber,city:e.data.address.city,postalCode:e.data.address.postalCode,addressInvalidMsg:""}),a.props.setUser(e.data),a.toggleForm({showAddressForm:!a.state.showAddressForm}))})).catch((function(e){console.log(e)})):a.setState({addressInvalidMsg:"The street, city and house number input should contain valid characters "})},a.cancelEditAddress=function(){a.setState({showAddressForm:!1})},a.updateAboutMe=function(e){e.preventDefault(),f.a.put("/api/user/".concat(a.state.username),{aboutMe:a.state.aboutMe}).then((function(e){a.setState({aboutMe:e.data.aboutMe},(function(){a.toggleForm({showAboutMeForm:!a.state.showAboutMeForm})}))})).catch((function(e){return console.log(e)}))},a.cancelEditAboutMe=function(){a.getData(),a.toggleForm({showAboutMeForm:!a.state.showAboutMeForm})},a.handleFileChange=function(e){var t=e.target.files[0];if(t)if(t.size>5e6)a.setState({canUpdateImg:!1,photoMessage:"Size of image should be less than 5MB",imageUrl:a.state.originalImgUrl});else if(["image/jpeg","image/png"].indexOf(t.type)<0)a.setState({canUpdateImg:!1,photoMessage:"Format of image should be jpeg or png",imageUrl:a.state.originalImgUrl});else{var n=new FormData;n.append("imageUrl",e.target.files[0]),a.setState({uploadOn:!0,photoMessage:""}),L(n).then((function(e){a.setState({imageUrl:e.secure_url,uploadOn:!1,canUpdateImg:!0,photoMessage:""})})).catch((function(e){console.log("Error while uploading the file: ",e)}))}else a.setState({canUpdateImg:!1,imageUrl:a.state.originalImgUrl})},a.handleSubmitFile=function(e){e.preventDefault(),a.state.uploadOn||f.a.put("/api/user/profile-pic/".concat(a.state.username),{imageUrl:a.state.imageUrl}).then((function(e){a.setState({imageUrl:e.data.imageUrl,photoMessage:"Image has been updated successfully",canUpdateImg:!1}),a.props.setUser(e.data)})).catch((function(e){return console.log(e)}))},a.handleSubmitOfferService=function(e){e.preventDefault(),""!==a.state.serviceInput&&f.a.put("/api/user/offer-service/".concat(a.state.username),{offerService:a.state.serviceInput.trim()}).then((function(e){a.setState({offerService:e.data.offerService,serviceInput:""})})).catch((function(e){return console.log(e)}))},a.deleteService=function(e){f.a.put("/api/user/offer-service-delete/".concat(a.state.username),{offerService:e}).then((function(e){a.setState({offerService:e.data.offerService})})).catch((function(e){return console.log(e)}))},a.handleSubmitOfferStuff=function(e){e.preventDefault(),a.state.stuffInput&&f.a.put("/api/user/offer-stuff/".concat(a.state.username),{offerStuff:a.state.stuffInput.trim()}).then((function(e){a.setState({offerStuff:e.data.offerStuff,stuffInput:""})})).catch((function(e){return console.log(e)}))},a.deleteStuff=function(e){f.a.put("/api/user/offer-stuff-delete/".concat(a.state.username),{offerStuff:e}).then((function(e){a.setState({offerStuff:e.data.offerStuff})})).catch((function(e){return console.log(e)}))},a.handleRefChange=function(e){var t;a.setState((t={},Object(o.a)(t,e.target.name,e.target.value),Object(o.a)(t,"showNeedtoWriteSth",!1),t))},a.handleCreditChange=function(e){var t;a.setState((t={},Object(o.a)(t,e.target.name,e.target.value),Object(o.a)(t,"showNotEnoughCredit",!1),t))},a.handleRatingChange=function(e){a.setState({rating:e})},a.cancelEditReference=function(){a.toggleForm({showReferenceAlert:!1,showReferenceForm:!1}),a.setState({rating:0,referenceInput:"",creditInput:"",showNotEnoughCredit:!1,showNeedtoWriteSth:!1})},a.addReference=function(e,t){if(e.preventDefault(),parseInt(a.state.authorCredits,10)-parseInt(a.state.creditInput,10)<0)a.setState({showNotEnoughCredit:!0,showReferenceAlert:!1});else if(a.state.referenceInput.trim()){if(a.toggleForm({showReferenceAlert:!0}),"final_submit"===t.name){var n=parseInt(a.state.creditInput,10);a.state.creditInput||(n=0),a.submitReference(n)}}else a.setState({showNeedtoWriteSth:!0,showReferenceAlert:!1})},a.submitReference=function(e){return f.a.post("api/reference",{content:a.state.referenceInput.trim(),rating:a.state.rating,recievedCredit:e,profileOwner:a.state._id}).then((function(e){a.setState({referenceInput:"",creditInput:"",rating:0,showReferenceAlert:!1,authorCredits:e.data.authorData.credits,credits:e.data.profileOwnerData.credits,reference:e.data.profileOwnerData.reference.reverse()})})).catch((function(e){return console.log(e)}))},a.deleteAccount=function(){f.a.delete("/api/user/".concat(a.state._id),{id:a.state._id}).then((function(e){a.props.history.push("/")})).catch((function(e){return console.log(e)}))},a.toggleDelAlertFunction=function(){a.setState({showDeleteAlert:!a.state.showDeleteAlert})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){e!==this.props&&this.getData()}},{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this,t=!1;return this.state._id===this.props.user._id&&(t=!0),this.state.error?r.a.createElement("h1",{className:"profile-detail-page"},this.state.error):r.a.createElement(w.a,{className:"my-md-5 px-lg-5 profile-detail-page"},r.a.createElement(S.a,null,r.a.createElement(F.a,{md:5,className:"my-4",id:"profile-left-top-container"},r.a.createElement(ee,{user:this.props.user,sameUser:t,imageUrl:this.state.imageUrl,handleFileChange:this.handleFileChange,handleSubmitFile:this.handleSubmitFile,photoMessage:this.state.photoMessage,canUpdateImg:this.state.canUpdateImg}),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",{style:{color:"grey"},className:"mt-md-4 profile-detail-subhead"},"Address\xa0\xa0\xa0",!this.state.showAddressForm&&r.a.createElement(y.a,{onClick:function(){return e.toggleForm({showAddressForm:!e.state.showAddressForm})},variant:"outline-info"},"\u270e")),this.state.showAddressForm&&r.a.createElement(b.a,{onSubmit:this.updateAddress},r.a.createElement(S.a,null,this.state.addressInvalidMsg&&r.a.createElement("p",{className:"warning col-12"},"* ",this.state.addressInvalidMsg),r.a.createElement(b.a.Group,{className:"col-7"},r.a.createElement(b.a.Label,{htmlFor:"street"},"Street: "),r.a.createElement(b.a.Control,{type:"text",name:"street",id:"street",value:this.state.street,onChange:this.handleChange,required:!0})),r.a.createElement(b.a.Group,{className:"col-4"},r.a.createElement(b.a.Label,{htmlFor:"houseNumber"},"Nr.: "),r.a.createElement(b.a.Control,{type:"text",name:"houseNumber",id:"houseNumber",onChange:this.handleChange,value:this.state.houseNumber,required:!0}))),r.a.createElement(S.a,null,r.a.createElement(b.a.Group,{className:"col-5"},r.a.createElement(b.a.Label,{htmlFor:"postalCode"},"Postalcode:"," "),r.a.createElement(b.a.Control,{type:"number",name:"postalCode",id:"postalCode",onChange:this.handleChange,value:this.state.postalCode,required:!0,min:"0"})),r.a.createElement(b.a.Group,{className:"col-6"},r.a.createElement(b.a.Label,{htmlFor:"city"},"City: "),r.a.createElement(b.a.Control,{type:"text",name:"city",id:"city",onChange:this.handleChange,value:this.state.city,required:!0}))),this.state.error&&r.a.createElement($.a,{variant:"danger"},this.state.error),r.a.createElement(y.a,{variant:"outline-success",type:"submit",className:"mr-2"},"Save"),r.a.createElement(y.a,{variant:"outline-danger",onClick:this.cancelEditAddress},"Cancel")),!this.state.showAddressForm&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"mb-0"},this.state.address.formattedAddress),r.a.createElement("p",{className:"mb-0",style:{color:"grey",fontStyle:"italic"}},"* Only you can see your address"))),r.a.createElement("h5",{className:"mt-md-4 profile-detail-subhead",style:{color:"grey"}},"Credit:"," ",r.a.createElement("span",{style:{color:"black"}},this.state.credits))),r.a.createElement(F.a,{md:7,className:"my-md-4"},r.a.createElement("h1",null,this.state.username,"\xa0\xa0",!t&&r.a.createElement(p.b,{to:"/messenger/".concat(this.state._id),className:"btn btn-outline-info",onClick:function(){e.props.setChatArea(!0)}},"\u2709"," Message me")),r.a.createElement(X,{sameUser:t,user:this.props.user,state:this.state,toggleForm:this.toggleForm,handleChange:this.handleChange,cancelEditAboutMe:this.cancelEditAboutMe,updateAboutMe:this.updateAboutMe})),r.a.createElement(F.a,{md:5,id:"lend-help-profile-box"},r.a.createElement(ae,{sameUser:t,offerStuff:this.state.offerStuff,showOfferStuffForm:this.state.showOfferStuffForm,toggleForm:this.toggleForm,handleChange:this.handleChange,stuffInput:this.state.stuffInput,handleSubmitOfferStuff:this.handleSubmitOfferStuff,deleteStuff:this.deleteStuff}),r.a.createElement("p",{className:"mt-md-5"}),r.a.createElement(te,{sameUser:t,offerService:this.state.offerService,showOfferServiceForm:this.state.showOfferServiceForm,toggleForm:this.toggleForm,handleChange:this.handleChange,serviceInput:this.state.serviceInput,handleSubmitOfferService:this.handleSubmitOfferService,deleteService:this.deleteService})),r.a.createElement(F.a,{md:7},r.a.createElement(le,{sameUser:t,user:this.props.user,toggleForm:this.toggleForm,handleChange:this.handleChange,cancelEditReference:this.cancelEditReference,addReference:this.addReference,showReferenceForm:this.state.showReferenceForm,showReferenceAlert:this.state.showReferenceAlert,rating:this.state.rating,referenceInput:this.state.referenceInput,creditInput:this.state.creditInput,reference:this.state.reference,showNotEnoughCredit:this.state.showNotEnoughCredit,showNeedtoWriteSth:this.state.showNeedtoWriteSth,authorCredits:this.state.authorCredits,profileOwner:this.state.username,handleRefChange:this.handleRefChange,handleCreditChange:this.handleCreditChange,handleRatingChange:this.handleRatingChange}))))}}]),t}(n.Component),ie=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",null,r.a.createElement("p",null,"\u24b8"," 2019 \xa0",r.a.createElement("a",{className:"footer-link",rel:"noopener noreferrer",href:"https://www.linkedin.com/in/johanna-geissler/",target:"_blank"},r.a.createElement("i",{className:"fab fa-linkedin"})," Hanna Gei\xdfler"),"\xa0\xa0",r.a.createElement("a",{className:"footer-link",rel:"noopener noreferrer",href:"https://www.linkedin.com/in/shanwong29/",target:"_blank"},r.a.createElement("i",{className:"fab fa-linkedin"})," Kam Shan Wong")),r.a.createElement("p",null,"Full code in our \xa0"," ",r.a.createElement("a",{className:"footer-link",rel:"noopener noreferrer",href:"https://github.com/shanwong29/Kiez",target:"_blank"},r.a.createElement("i",{className:"fab fa-github"})," Github Repository")))}}]),t}(n.Component),ce=a(73),me=a.n(ce),ue=Object({NODE_ENV:"production",PUBLIC_URL:""}).PORT,he=me()(ue),de=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={user:a.props.user,allUsers:[],allEvents:[],select:"",searchInput:"",selectInputfield:"",searchInputfield:"",showNewsfeed:!0,showMyEvents:!1,showEventsGoing:!1,showNextEvents:!1,sender:a.props.user._id,reciever:"",chatMsg:[],chatInput:"",recieverAction:"",showChatArea:!1},a.setChatArea=function(e){a.setState({showChatArea:e})},a.handleChangeNav=function(e){a.setState(e),a.getAllUser(),a.getAllEvents()},a.setUser=function(e){a.setState({user:e})},a.handleChange=function(e){a.setState(Object(o.a)({},e.target.name,e.target.value))},a.getAllUser=function(){f.a.get("/api/user").then((function(e){a.setState({allUsers:e.data})})).catch((function(e){console.log(e)}))},a.getAllEvents=function(){f.a.get("/api/events/myevents").then((function(e){a.setState({allEvents:e.data})})).catch((function(e){console.log(e)}))},a.getMsg=function(){f.a.get("/api/chat/chat-msg").then((function(e){a.setState({chatMsg:e.data,chatInput:""})})).catch((function(e){console.log(e)}))},a.handleChatInputSubmit=function(e,t){e.preventDefault(),a.state.chatInput&&f.a.post("/api/chat/chat-msg",{chatMsg:a.state.chatInput,reciever:t}).then((function(e){he.send(e.data),a.getMsg()})).catch((function(e){return console.log(e)}))},a.handleQuery=function(e,t){e.preventDefault(),a.state.selectInputfield&&(a.getAllUser(),a.setState({searchInput:a.state.searchInputfield,select:a.state.selectInputfield}),t&&t.push("/search-result"))},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getAllUser(),this.getAllEvents(),this.getMsg(),he.on("message",(function(t){e.getMsg()}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(d.b,{render:function(t){return r.a.createElement(N,{user:e.state.user,clearUser:e.setUser,select:e.state.select,searchInput:e.state.searchInput,selectInputfield:e.state.selectInputfield,searchInputfield:e.state.searchInputfield,handleChange:e.handleChange,handleQuery:e.handleQuery,getAllUser:e.getAllUser,history:t.history,handleChangeNav:e.handleChangeNav,showNewsfeed:e.state.showNewsfeed,showMyEvents:e.state.showMyEvents,showEventsGoing:e.state.showEventsGoing,showNextEvents:e.state.showNextEvents})}}),r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",render:function(t){return e.state.user?r.a.createElement(R,Object.assign({},t,{user:e.state.user,getAllEvents:e.getAllEvents,allEvents:e.state.allEvents,state:e.state,showNewsfeed:e.state.showNewsfeed,showMyEvents:e.state.showMyEvents,showEventsGoing:e.state.showEventsGoing,showNextEvents:e.state.showNextEvents,handleChangeNav:e.handleChangeNav,chatMsg:e.state.chatMsg})):r.a.createElement(d.a,{to:"/signup"})}}),r.a.createElement(d.b,{exact:!0,path:"/search-result",render:function(t){return e.state.user?r.a.createElement(B,Object.assign({},t,{user:e.state.user,allUsers:e.state.allUsers,select:e.state.select,searchInput:e.state.searchInput})):r.a.createElement(d.a,{to:"/signup"})}}),r.a.createElement(d.b,{exact:!0,path:"/messenger/:neighborId",render:function(t){return e.state.user?r.a.createElement(K,Object.assign({},t,{allUsers:e.state.allUsers,user:e.state.user,chatMsg:e.state.chatMsg,chatInput:e.state.chatInput,handleChange:e.handleChange,handleChatInputSubmit:e.handleChatInputSubmit,getMsg:e.getMsg,setRecieverAction:e.setRecieverAction,setChatArea:e.setChatArea,showChatArea:e.state.showChatArea})):r.a.createElement(d.a,{to:"/signup"})}}),r.a.createElement(d.b,{exact:!0,path:"/signup",render:function(t){return r.a.createElement(V,Object.assign({},t,{setUser:e.setUser}))}}),r.a.createElement(d.b,{exact:!0,path:"/login",render:function(t){return r.a.createElement(Z,Object.assign({},t,{setUser:e.setUser}))}}),r.a.createElement(d.b,{exact:!0,path:"/:username",render:function(t){return e.state.user?r.a.createElement(oe,Object.assign({},t,{user:e.state.user,allUsers:e.state.allUsers,setUser:e.setUser,setChatArea:e.setChatArea})):r.a.createElement(d.a,{to:"/signup"})}}),r.a.createElement(d.b,{exact:!0,path:"/events/create",render:function(t){return e.state.user?r.a.createElement(W,Object.assign({},t,{getAllEvents:e.getAllEvents})):r.a.createElement(d.a,{to:"/signup"})}}),r.a.createElement(d.b,{exact:!0,path:"/events/:id",render:function(t){return r.a.createElement(H,Object.assign({},t,{state:e.state,user:e.state.user,allUsers:e.state.allUsers,getAllEvents:e.getAllEvents}))}})),r.a.createElement(ie,null))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));f.a.get("/api/auth/loggedin").then((function(e){var t=e.data;l.a.render(r.a.createElement(p.a,null,r.a.createElement(de,{user:t})),document.getElementById("root"))})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},77:function(e,t,a){e.exports=a(138)},82:function(e,t,a){},83:function(e,t,a){}},[[77,1,2]]]);
//# sourceMappingURL=main.3972f779.chunk.js.map